{"version":3,"sources":["components/MidiPorts.js","components/SheetOverlay.js","components/ReadExcel.js","components/ExportExcel.js","components/Window.js","components/HelpButton.js","components/CopyButton.js","components/SendButton.js","components/NoteTranslator.js","components/Monitor.js","App.js","index.js"],"names":["MidiPorts","props","WebMidi","enable","err","alert","inputPort","inputs","outputPort","outputs","setAll","setInput","setOutput","className","onChange","e","getInputByName","target","value","map","port","id","name","getOutputByName","SheetOverlay","setShowSheets","showSheets","sheetNames","parseSheet","onClick","sheet","ExcelReader","useState","setSheetNames","XL","setXL","worksheet","Sheets","data","XLSX","sheet_to_json","header","sheetObj","MAX","length","i","push","index","test","behavior","sysex","expected","expectedLength","response","responseLength","passFail","setItems","console","log","table","setHelp","help","type","file","fileReader","FileReader","readAsArrayBuffer","regEx","onload","bufferArray","result","wb","SheetNames","onerror","abort","readExcel","files","ExportExcel","newWorkBook","book_new","resultsSheet","json_to_sheet","book_append_sheet","Window","href","HelpButton","CopyButton","dataLength","copied","setCopied","text","join","clipboard","navigator","writeText","SendButton","sent","setSent","noteChart","noteTranslator","note","parseInt","Number","key","octave","j","Monitor","input","hex","output","allPorts","showMonitor","setShowMonitor","setLog","inputPorts","allMessages","allInputs","logData","forEach","inp","addListener","reply","timestamp","time","message","document","querySelectorAll","col","scrollTop","scrollHeight","useEffect","removeListener","classColors","msg","App","items","setAllPorts","viewHelp","setViewHelp","clickHandler","split","el","statusByte","splice","fullMsg","send","groupEnd","prev","newitems","entry","byteComparison","updateData","decimalToHex","receiveSysex","group","toString","toUpperCase","undefined","ReactDOM","render","StrictMode","getElementById"],"mappings":"sSAoDeA,EAjDG,SAAAC,GAed,OAdAC,IAAQC,QAAO,SAAUC,GAEjBA,GAAKC,MAAM,gCAAiCD,GAChD,IAAIE,EAAYJ,IAAQK,OAAO,GAC3BC,EAAaN,IAAQO,QAAQ,GACjCR,EAAMS,OAAO,CAAC,YAAIR,IAAQK,QAAb,YAA0BL,IAAQO,WAC/CR,EAAMU,SAASL,GACfL,EAAMW,UAAUJ,MACjB,GAOC,sBAAKK,UAAU,aAAf,UACI,gCACI,sBAAMA,UAAU,aAAhB,0BACA,wBACIA,UAAU,oBACVC,SAAU,SAAAC,GACNd,EAAMU,SAAST,IAAQc,eAAeD,EAAEE,OAAOC,SAHvD,SAMKhB,IAAQK,OAAOY,KAAI,SAAAC,GAAI,OACpB,wBAAsBC,GAAID,EAAKC,GAA/B,SACKD,EAAKE,MADGF,EAAKC,YAM9B,gCACI,sBAAMR,UAAU,aAAhB,2BACA,wBACIA,UAAU,qBACVC,SAAU,SAAAC,GACNd,EAAMW,UAAUV,IAAQqB,gBAAgBR,EAAEE,OAAOC,SAHzD,SAMKhB,IAAQO,QAAQU,KAAI,SAAAC,GAAI,OACrB,iCAAuBA,EAAKE,MAAfF,EAAKC,gB,OCjB3BG,MAzBf,YAA8E,IAAtDC,EAAqD,EAArDA,cAAeC,EAAsC,EAAtCA,WAAYC,EAA0B,EAA1BA,WAAYC,EAAc,EAAdA,WAC3D,OACI,sBAAKf,UAAU,uBAAuBgB,QAAS,SAAAd,GAAC,OAAIU,GAAeC,IAAnE,UACI,gEACA,qBAAKb,UAAU,kBAAf,SACKa,EACKC,EAAWR,KAAI,SAAAW,GAAK,OAChB,8BACI,qBACID,QAAS,SAAAd,GACLa,EAAWb,EAAEE,OAAOI,KAExBA,GAAIS,EACJjB,UAAU,QALd,SAOKiB,KARCA,MAYd,SC0EPC,MAxFf,SAAqB9B,GACjB,MAAoC+B,qBAApC,mBAAON,EAAP,KAAmBD,EAAnB,KACA,EAAoCO,mBAAS,IAA7C,mBAAOL,EAAP,KAAmBM,EAAnB,KACA,EAAoBD,mBAAS,IAA7B,mBAAOE,EAAP,KAAWC,EAAX,KAgCA,SAASP,EAAWX,GAShB,IARA,IAAMmB,EAAYF,EAAGG,OAAOpB,GACtBqB,EAAOC,QAAWC,cAAcJ,EAAW,CAAEK,OAAQ,IAGvDC,EAAW,GACTC,EAAML,EAAKM,OAGRC,EAFG,EAEQA,EAAIF,EAAKE,IACzBH,EAASI,KAAK,CACVC,MAAOF,EAJH,EAKJvB,KAAMgB,EAAKO,GAAG,GACdzB,KAAMkB,EAAKO,GAAG,GACdG,KAAMV,EAAKO,GAAG,GACdI,SAAUX,EAAKO,GAAG,GAClBK,MAAOZ,EAAKO,GAAG,GACfM,SAAUb,EAAKO,GAAG,GAClBO,eAAgB,KAChBC,SAAU,GACVC,eAAgB,KAChBC,SAAU,OAKlBtD,EAAMuD,SAASd,GAGfe,QAAQC,IAAI,6BACZD,QAAQE,MAAMjB,GACdzC,EAAM2D,SAAS3D,EAAM4D,MACrBpC,GAAc,GAGlB,OACI,qCACKC,EAAa,cAAC,EAAD,CAAcD,cAAeA,EAAeC,WAAYA,EAAYC,WAAYA,EAAYC,WAAYA,IAAiB,GACvI,wBAAOf,UAAU,SAAjB,yBAEI,uBACIiD,KAAK,OACLjD,UAAU,OACVC,SAAU,SAAAC,IAzE1B,SAAmBgD,GACf,IAAMC,EAAa,IAAIC,WACvBD,EAAWE,kBAAkBH,GAC7B,IAAII,EAAQ,QAEZH,EAAWI,OAAS,SAAArD,GAChB,IAA8B,IAA1BoD,EAAMnB,KAAKe,EAAKzC,MAApB,CAIA,IAAM+C,EAActD,EAAEE,OAAOqD,OAEvBC,EAAKhC,OAAU8B,EAAa,CAAEP,KAAM,WAC1C3B,EAAMoC,GACNtC,EAAcsC,EAAGC,YACjB/C,GAAc,QARVpB,MAAM,oFAYd2D,EAAWS,QAAU,SAAA1D,GACjBV,MAAM,+BACN2D,EAAWU,SAsDCC,CADa5D,EAAEE,OAAO2D,MAAM,cCjErCC,MAjBf,SAAqB5E,GAEjB,IAAI6E,EAAcvC,QAAWwC,WACzBC,EAAezC,QAAW0C,cAAchF,EAAMqC,MAIlD,OAHAC,QAAW2C,kBAAkBJ,EAAaE,EAAc,iBAIpD,8BAEI,wBAAQnE,UAAU,SAASgB,QAAS,kBAAMU,YAAeuC,EAAa,uBAAtE,oCCuCGK,MAnDf,WAEI,OACI,sBAAKtE,UAAU,SAAf,UACI,0BAASA,UAAU,iBAAnB,UACI,2DACA,uXAFJ,sBASA,0BAASA,UAAU,kBAAnB,UACI,mDACA,8BACK,IADL,oCAEsC,IAClC,mBAAGuE,KAAK,IAAInE,OAAO,SAAnB,8BAIJ,uKAEW,OAEX,4GACA,6JACA,+IACkH,uBADlH,qMAKA,4GApBJ,sBAuBA,0BAASJ,UAAU,iBAAnB,UACI,sBADJ,yDAGI,sBAHJ,4FAKI,sBALJ,qFAOI,sBAPJ,8EASI,6BClCDwE,MAVf,YAAwC,IAAlBxB,EAAiB,EAAjBA,KAAMD,EAAW,EAAXA,QACxB,OACI,mCACI,wBAAQ/C,UAAU,qBAAqBgB,QAAS,kBAAM+B,GAASC,IAA/D,qBCmBGyB,MAtBf,YAA2C,IAArBhD,EAAoB,EAApBA,KAAMiD,EAAc,EAAdA,WACxB,EAA4BvD,mBAAS,QAArC,mBAAOwD,EAAP,KAAeC,EAAf,KAYA,OACI,qBAAK5E,UAAU,kBAAf,SACI,wBAAQA,UAAsB,SAAX2E,EAAoB,cAAgB,qBAAsB3D,QAZrF,SAAkBd,GACd,IAAM2E,EAAI,UAAMpD,EAAKqD,KAAK,IAAhB,aAAwBJ,EAAxB,UACJK,EAAYC,UAAUD,UACvBA,IAGLA,EAAUE,UAAUJ,GACpBD,EAAU,YAKN,SACKD,OCEFO,MAnBf,SAAoB9F,GAChB,MAAwB+B,oBAAS,GAAjC,mBAAOgE,EAAP,KAAaC,EAAb,KAEA,OACI,mCACI,wBACIpF,UAAWmF,EAAO,0BAA4B,qBAC9C3E,GAAIpB,EAAMoB,GACVQ,QAAS,SAAAd,GACLd,EAAM4B,QAAQd,GACdkF,GAAQ,IALhB,SAQI,sBAAMpF,UAAU,YAAhB,SAA6BmF,EAAO,OAAS,cCfvDE,EAAY,CACd,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,IAAK,KAAM,IAAK,KAAM,KAC7D,CAAC,IAAK,KAAM,IAAK,KAAM,IAAK,IAAK,KAAM,MAoB5BC,MAjBf,SAAwBC,GAEpBA,EAAOC,SAASC,OAAO,KAAOF,EAAM,KAIpC,IAFA,IAAIG,EAAM,EACNC,GAAU,EACL3D,EAAI,EAAGA,EAAIqD,EAAUtD,OAAQC,IAAK,CACvC,IAAK,IAAI4D,EAAI,EAAGA,EAAIP,EAAUrD,GAAGD,OAAQ6D,IAAK,CAC1C,GAAIL,IAASG,EACT,OAAOL,EAAUrD,GAAG4D,GAAKD,EAE7BD,IAEJC,MCoGOE,MA1Hf,YAAiF,IAA9DC,EAA6D,EAA7DA,MAAeC,GAA8C,EAAtDC,OAAsD,EAA9CD,KAAKE,EAAyC,EAAzCA,SAAUC,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eAC1D,EAAsBhF,mBAAS,IAA/B,mBAAO0B,EAAP,KAAYuD,EAAZ,KACA,EAAoCjF,mBAAS8E,EAAS,IAAtD,mBAAOI,EAAP,KACA,GADA,KAC4ClF,mBAAS8E,EAAS,KAA9D,mBACMK,GADN,UACoB,IACdC,EAAYN,EAAS,GAG3B,SAASO,IACLD,EAAUE,SAAQ,SAACC,EAAKxE,GACpBwE,EAAIC,YAAY,cAAe,OAAO,SAAAzG,GAClC,IAAM0G,EAAQb,EAAI,YAAI7F,EAAEuB,OAClBoF,EAAYrB,SAAStF,EAAE2G,WAE7BP,EAAYrE,KAAK,CAAE1B,KAAML,EAAEE,OAAOK,KAAMqG,KAAMD,EAAWE,QAASH,IAIlER,EAAO,GAAD,OAAKE,IAoBPU,SAASC,iBAAiB,mBAChCR,SAAQ,SAAAS,GAAG,OAAKA,EAAIC,UAAYD,EAAIE,sBAjC3BnB,EAAS,GAqC5BoB,qBAAU,WAGN,OAFAzE,QAAQC,IAAI,UACZ2D,IACO,WACHV,EAAMwB,eAAe,cAAe,OACpC1E,QAAQC,IAAI,cAEjB,CAACiD,IAmBJ,IAAMyB,EAAc,CAAC,OAAQ,SAAU,UAAW,UAElD,OACI,sBAAKvH,UAAU,oBAAf,UACI,yBAAQA,UAAU,uBAAuBgB,QAAS,kBAAMmF,GAAgBD,IAAxE,0BACiB,sBAAMlG,UAAU,SAAhB,mBAWjB,qBAAKA,UAAU,kBAAf,SAMKqG,EAAW/F,KAAI,SAACC,EAAM2B,GAAP,OACZ,sBAAmBlC,UAAU,oBAA7B,UACI,qBAAKQ,GAAID,EAAKE,KAAMT,UAAS,uBAAkBuH,EAAYrF,IAA3D,SACK3B,EAAKE,OAEV,qBAAmBT,UAAS,iBAA5B,SACK6C,EAAIvC,KAAI,SAAAkH,GACL,OAAIA,EAAIjH,OAASA,EAAKE,KAEd,sBAAKT,UAAU,eAAf,UAEI,qBAAKQ,GAAG,iBAAR,SAA0BgH,EAAIT,UACN,IAAvBS,EAAIT,QAAQhF,OACT,qBAAKvB,GAAG,kBAAR,qBAAgC8E,EAAekC,EAAIT,QAAQ,IAA3D,QAEA,wBAEJ,qBAAKvG,GAAG,kBAAR,SAA2BgH,EAAIV,SARAU,EAAIV,MAYxC,OAhBLvG,EAAKC,MAJTD,EAAKC,a,YCgHpBiH,MA7Lf,WACI,MAA0BtG,mBAAS,IAAnC,mBAAOuG,EAAP,KAAc/E,EAAd,KACA,EAA0BxB,qBAA1B,mBAAO2E,EAAP,KAAchG,EAAd,KACA,EAA4BqB,qBAA5B,mBAAO6E,EAAP,KAAejG,EAAf,KACA,EAAgCoB,mBAAS,IAAzC,mBAAO8E,EAAP,KAAiB0B,EAAjB,KACA,EAAgCxG,oBAAS,GAAzC,mBAAOyG,EAAP,KAAiBC,EAAjB,KACA,EAAsC1G,oBAAS,GAA/C,mBAAO+E,EAAP,KAAoBC,EAApB,KAEA,SAAS2B,EAAa5H,GAClB0C,QAAQC,IAAI,OAAQ3C,GACpB,IAAME,EAASoF,SAAStF,EAAEE,OAAOI,IAa3BuG,EAJIW,EAAMtH,GAAQiC,MACJ0F,MAAM,KAGAzH,KAAI,SAAA0H,GAE1B,OADAA,EAAK,KAAOA,EACLxC,SAASC,OAAOuC,EAAI,QAIzBC,EAAalB,EAAQmB,OAAO,EAAG,GAC/BC,EAAO,UAAMF,EAAN,YAAoBlB,GAQ7Bf,GACAA,EAAOoC,KAAKH,EAAYlB,GAShC,SAAsB3G,GAoBlBwC,QAAQyF,SAAS,OACjBvC,EAAMwB,eAAe,QAAS,OAnB9BxB,EAAMa,YAAY,QAAS,OAAO,SAAAzG,GAC9B0C,QAAQC,IAAI,SAAUzC,GACtB,IAAMwG,EAAK,YAAO1G,EAAEuB,MAGfmF,GAAOpH,MAAM,sCAElBoD,QAAQC,IAAR,mBAAwB+D,EAAxB,aAAkCA,EAAM7E,OAAxC,sBAA4D+D,EAAMrF,KAAlE,UACAmC,QAAQyF,SAAS,OAEbzB,GAwBZ,SAAoBxG,EAAQoC,GACxBG,GAAS,SAAA2F,GACL,IAAMC,EAAWD,EAAKhI,KAAI,SAAAkI,GAYtB,OAXIA,EAAMtG,QAAU9B,IAChBoI,EAAMhG,SAAWA,EACjBgG,EAAMjG,eAAiBiG,EAAMlG,SAASyF,MAAM,KAAKhG,OACjDyG,EAAM/F,eAVtB,SAAwBsE,GACpB,OAAOA,EAAQhF,OASoB0G,CAAejG,IAEtCgG,EAAM/F,iBAAmB+F,EAAMjG,iBAC/BiG,EAAM9F,SAAW,QAEjB8F,EAAM/F,iBAAmB+F,EAAMjG,iBAC/BiG,EAAM9F,SAAW,QAEd8F,KAGX,OADApI,EAAS,KACFmI,KAxCHG,CAAWtI,EAAQuI,EAAa/B,OArBpCgC,CAAaxI,GACbwC,QAAQiG,MAAM,OACdjG,QAAQC,IAAR,eAAoBsF,EAApB,aAAgCA,EAAQpG,OAAxC,sBAA4DiE,EAAOvF,KAAnE,WAEAjB,MAAM,gCA2Bd,SAASmJ,EAAa/B,GAMlB,OALkBA,EAAMtG,KAAI,SAAA0H,GAGxB,OADkB,KADlBA,EAAKA,EAAGc,SAAS,IAAM,KAChB/G,SAAciG,EAAK,IAAMA,GACzBA,EAAGe,iBA8BlB,OACI,sBAAK/I,UAAU,YAAf,UACI,mBAAGA,UAAU,QAAb,iCACA,sBAAKA,UAAU,YAAf,UACI,cAAC,EAAD,CAAa2C,SAAUA,EAAUI,QAAS8E,EAAa7E,KAAM4E,IAC7D,cAAC,EAAD,CAAanG,KAAMiG,IACnB,cAAC,EAAD,CAAW5H,SAAUA,EAAUC,UAAWA,EAAW+F,MAAOA,EAAOE,OAAQA,EAAQnG,OAAQ8H,IAC3F,wBAAQ3H,UAAU,SAASgB,QAAS,kBAAMmF,GAAgBD,IAA1D,0BAGA,cAAC,EAAD,CAAYlD,KAAM4E,EAAU7E,QAAS8E,OAExCD,EAAW,cAAC,EAAD,IAAa,GACzB,sBAAK5H,UAAU,iBAAf,UACI,wBAAOA,UAAU,kBAAjB,UACI,gCACI,qBAAIA,UAAW0H,EAAM3F,OAAS,EAAI,eAAiB,YAAnD,UACI,oBAAI/B,UAAU,eAAd,0BACA,sCACA,sCACA,mDACA,+CACA,mDACA,+CAGR,gCACK0H,EAAMpH,KAAI,SAACmB,EAAMS,GAAP,OACP,qBAAgBlC,eAAyBgJ,IAAdvH,EAAKlB,KAAqB,gBAAkB,YAAvE,UACI,oBAAIP,UAAU,WAAd,SAA0ByB,EAAKhB,OAC/B,oBAAIT,UAAU,OAAd,SAAsByB,EAAKlB,OAE3B,oBAAIP,UAAU,cAAd,SAA6ByB,EAAKU,OAClC,oBAAInC,UAAU,WAAd,SAA0ByB,EAAKW,WAC/B,oBAAIpC,UAAU,kBAAd,SACI,sBAAKA,UAAWyB,EAAKY,MAAQ,aAAe,YAA5C,UACKZ,EAAKY,MACN,cAAC,EAAD,CAAY7B,GAAI0B,EAAOlB,QAAS8G,SAOxC,oBAAI9H,UAAU,gBAAd,SACI,sBAAKA,UAAU,WAAf,UACKyB,EAAKa,SACN,qBAAKtC,UAA6B,SAAlByB,EAAKiB,SAAsB,OAAS,OAApD,SACKjB,EAAKc,eAAL,oBAAmCd,EAAKc,eAAxC,UAAiE,UAI9E,qBAAIvC,UAAU,gBAAd,UACI,sBAAKA,UAAU,WAAf,UACKyB,EAAKe,SACN,qBAAKxC,UAA6B,SAAlByB,EAAKiB,SAAsB,OAAS,OAApD,SACKjB,EAAKgB,eAAL,oBAAmChB,EAAKgB,eAAxC,UAAiE,QAGzEhB,EAAKgB,eAAiB,EAAI,cAAC,EAAD,CAAYhB,KAAMA,EAAKe,SAAUkC,WAAYjD,EAAKgB,sBAAqBuG,OA/BjG9G,WAqCpB4D,GAASI,EACN,cAAC,EAAD,CACIJ,MAAOA,EACPE,OAAQA,EACRD,IAAK4C,EACL1C,SAAUA,EACVC,YAAaA,EACbC,eAAgBA,IAGpB,UCpMpB8C,IAASC,OACL,cAAC,IAAMC,WAAP,UACI,cAAC,EAAD,MAEJnC,SAASoC,eAAe,U","file":"static/js/main.c000b5fd.chunk.js","sourcesContent":["import React from 'react';\nimport WebMidi from 'webmidi';\nimport '../App.css';\nconst MidiPorts = props => {\n    WebMidi.enable(function (err) {\n        // If midi ports aren't found, log error\n        if (err) alert('WebMidi could not be enabled.', err);\n        let inputPort = WebMidi.inputs[0]; //WebMidi.getInputByName(inputEl.value);\n        let outputPort = WebMidi.outputs[0];\n        props.setAll([[...WebMidi.inputs], [...WebMidi.outputs]]);\n        props.setInput(inputPort);\n        props.setOutput(outputPort);\n    }, true);\n\n    // setInterval(() => {\n    //     props.setAll([[...WebMidi.inputs], [...WebMidi.outputs]]);\n    // }, 3000);\n\n    return (\n        <div className='midi-ports'>\n            <div>\n                <span className='port-label'>Input Port: </span>\n                <select\n                    className='ports input-ports'\n                    onChange={e => {\n                        props.setInput(WebMidi.getInputByName(e.target.value));\n                    }}\n                >\n                    {WebMidi.inputs.map(port => (\n                        <option key={port.id} id={port.id}>\n                            {port.name}\n                        </option>\n                    ))}\n                </select>\n            </div>\n            <div>\n                <span className='port-label'>Output Port: </span>\n                <select\n                    className='ports output-ports'\n                    onChange={e => {\n                        props.setOutput(WebMidi.getOutputByName(e.target.value));\n                    }}\n                >\n                    {WebMidi.outputs.map(port => (\n                        <option key={port.id}>{port.name}</option>\n                    ))}\n                </select>\n            </div>\n        </div>\n    );\n};\n\nexport default MidiPorts;\n","import React from 'react';\n\nfunction SheetOverlay({ setShowSheets, showSheets, sheetNames, parseSheet }) {\n    return (\n        <div className='sheet-select-overlay' onClick={e => setShowSheets(!showSheets)}>\n            <h2>Please select a sheet to load:</h2>\n            <div className='sheet-container'>\n                {showSheets\n                    ? sheetNames.map(sheet => (\n                          <div key={sheet}>\n                              <div\n                                  onClick={e => {\n                                      parseSheet(e.target.id);\n                                  }}\n                                  id={sheet}\n                                  className='sheet'\n                              >\n                                  {sheet}\n                              </div>\n                          </div>\n                      ))\n                    : ''}\n            </div>\n        </div>\n    );\n}\n\nexport default SheetOverlay;\n","import React, { useState } from 'react';\nimport * as XLSX from 'xlsx';\nimport SheetOverlay from './SheetOverlay';\nimport '../App.css';\n\n//TODO: add more error handling. for instance, if the loaded excel sheet doesn't look right, take user through putting in the name of the sheet, the index of the first cell, etc.\n//TODO: add window component that shows the worksheet names\nfunction ExcelReader(props) {\n    const [showSheets, setShowSheets] = useState();\n    const [sheetNames, setSheetNames] = useState([]);\n    const [XL, setXL] = useState({});\n\n    function readExcel(file) {\n        const fileReader = new FileReader();\n        fileReader.readAsArrayBuffer(file);\n        let regEx = /xlsx$/;\n\n        fileReader.onload = e => {\n            if (regEx.test(file.name) === false) {\n                alert('ERROR: Incompatible file type.  Please upload a file with an extension of .xlsx');\n                return;\n            }\n            const bufferArray = e.target.result;\n\n            const wb = XLSX.read(bufferArray, { type: 'buffer' });\n            setXL(wb);\n            setSheetNames(wb.SheetNames);\n            setShowSheets(true);\n            // parseSheet(wb);\n        };\n\n        fileReader.onerror = e => {\n            alert('unknown error. please retry');\n            fileReader.abort();\n        };\n    }\n\n    function clickHandler(e) {\n        const target = e.target.id;\n        parseSheet(target);\n    }\n\n    function parseSheet(target) {\n        const worksheet = XL.Sheets[target];\n        const data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n        // Uncomment to see how we're parsing the data below\n        // console.table('data', data);\n        let sheetObj = [];\n        const MAX = data.length;\n        let start = 3; // Start of the actual data\n\n        for (let i = start; i < MAX; i++) {\n            sheetObj.push({\n                index: i - start,\n                name: data[i][0],\n                port: data[i][1],\n                test: data[i][2],\n                behavior: data[i][3],\n                sysex: data[i][4],\n                expected: data[i][5],\n                expectedLength: null,\n                response: '',\n                responseLength: null,\n                passFail: null,\n            });\n        }\n\n        // Set state\n        props.setItems(sheetObj);\n\n        // Log output\n        console.log('Worksheet load successful');\n        console.table(sheetObj);\n        props.setHelp(!props.help);\n        setShowSheets(false);\n    }\n\n    return (\n        <>\n            {showSheets ? <SheetOverlay setShowSheets={setShowSheets} showSheets={showSheets} sheetNames={sheetNames} parseSheet={parseSheet} /> : ''}\n            <label className='button'>\n                Import Sheet\n                <input\n                    type='file'\n                    className='file'\n                    onChange={e => {\n                        const file = e.target.files[0];\n                        readExcel(file);\n                    }}\n                />\n            </label>\n        </>\n    );\n}\n\nexport default ExcelReader;\n","import React from 'react';\nimport * as XLSX from 'xlsx';\nimport '../App.css';\n\nfunction ExportExcel(props) {\n    // This is the 'items' state, the full data object\n    let newWorkBook = XLSX.utils.book_new(); // create new workbook\n    let resultsSheet = XLSX.utils.json_to_sheet(props.data); //can also use XLSX.utils.sheet_add_json to add to existing\n    XLSX.utils.book_append_sheet(newWorkBook, resultsSheet, 'Sysex Results'); // Add new worksheet to new workbook\n\n    // https://www.youtube.com/watch?v=tKz_ryychBY&list=PLQ9Y_YUSECCg0uiQR-Uj8E2a8fxTelcNB&index=3&t=1197s\n    return (\n        <div>\n            {/* skipHeader: false if we want to remove the header */}\n            <button className='button' onClick={() => XLSX.writeFile(newWorkBook, 'sysex-results.xlsx')}>\n                Export to New Sheet\n            </button>\n        </div>\n    );\n}\n\nexport default ExportExcel;\n","import React from 'react';\n\nfunction Window() {\n    // This will show when the page is loaded.  once a file is imported, it can be accessed via the help button\n    return (\n        <div className='window'>\n            <section className='window__header'>\n                <h4>Welcome to SysEx Tester 9</h4>\n                <p>\n                    Inspired by T9 predictive text message technology used in early mobile phones, Sysex-T9 aims to make it easier to send large\n                    amounts of SysEx messages to your MIDI devices. Sysex T9 will import your excel sheets and parse the cells for sysex data, where\n                    you will be able to send the messages to your MIDI device while monitoring the response.\n                </p>\n                ________________\n            </section>\n            <section className='window__content'>\n                <p> To use Sysex-T9: </p>\n                <p>\n                    {' '}\n                    1. Create an excel sheet based on{' '}\n                    <a href='.' target='_blank'>\n                        this template\n                    </a>\n                </p>\n                <p>\n                    2. Click the Import Sheet button. NOTE: This menu will disappear once a sheet is imported. Access this window again by clicking\n                    [help]{' '}\n                </p>\n                <p>3. Make sure your Input and Output Ports are set to the proper MIDI Device </p>\n                <p> 4. Click Send to send each SysEx message. If the message is successful, the response will be written to the Response cell. </p>\n                <p>\n                    5. Along with the Sysex response message, the amount of bytes sent and received will be written and compared. <br />\n                    If the number of bytes of the response matches the expected number of bytes, the message will be colored green. If the incorrect\n                    amount of bytes are received, the message will be colored red.\n                </p>\n                <p>6. Once finished, [Export to New Sheet] and save the results to your system</p>\n                ________________\n            </section>\n            <section className='window__footer'>\n                <p />\n                If you want to see more data while operating Sysex T9:\n                <p />\n                1. Open up the console on your browser by right clicking anywhere and clicking [Inspect].\n                <p />\n                2. Click on the [Console] tab to get readouts of the data being sent and received.\n                <p />\n                If you want to access this menu again, press the [help] button at any time.\n                <p />\n            </section>\n        </div>\n    );\n}\n\nexport default Window;\n","import { React, useState } from 'react';\nimport Window from './Window';\n\nfunction HelpButton({ help, setHelp }) {\n    return (\n        <>\n            <button className='button help-button' onClick={() => setHelp(!help)}>\n                help\n            </button>\n        </>\n    );\n}\n\nexport default HelpButton;\n","// Copy to clipboard\nimport React, { useState } from 'react';\n\nfunction CopyButton({ data, dataLength }) {\n    const [copied, setCopied] = useState('copy');\n\n    function copyText(e) {\n        const text = `${data.join('')}  ${dataLength} bytes`;\n        const clipboard = navigator.clipboard;\n        if (!clipboard) {\n            return;\n        }\n        clipboard.writeText(text);\n        setCopied('copied');\n    }\n\n    return (\n        <div className='copy__container'>\n            <button className={copied === 'copy' ? 'copy button' : 'copy button copied'} onClick={copyText}>\n                {copied}\n            </button>\n        </div>\n    );\n}\n\nexport default CopyButton;\n","import React, { useState } from 'react';\n\nfunction SendButton(props) {\n    const [sent, setSent] = useState(false);\n\n    return (\n        <>\n            <button\n                className={sent ? 'button send-button sent' : 'button send-button'}\n                id={props.id}\n                onClick={e => {\n                    props.onClick(e);\n                    setSent(true);\n                }}\n            >\n                <span className='send-text'>{sent ? 'sent' : 'send'}</span>\n            </button>\n        </>\n    );\n}\n\nexport default SendButton;\n","const noteChart = [\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'], // Octave -1\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'], // Octave 0\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'], // Octave 1\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'], // Octave 2\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'], // etc\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'],\n    ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G'], //.................... Octave 9\n];\n\nfunction noteTranslator(note) {\n    // note = parseInt(Number(note, 10));\n    note = parseInt(Number('0x' + note, 10));\n\n    let key = 0;\n    let octave = -1; // MIDI Spec octave sarts at -1\n    for (let i = 0; i < noteChart.length; i++) {\n        for (let j = 0; j < noteChart[i].length; j++) {\n            if (note === key) {\n                return noteChart[i][j] + octave;\n            }\n            key++;\n        }\n        octave++;\n    }\n}\n\nexport default noteTranslator;\n","import React, { useEffect, useState } from 'react';\nimport noteTranslator from './NoteTranslator';\n\n//TODO: make the monitor show every midi device and port then have them clickable to show or hide different ports\n// I can filter out the log data based on port name, and it matching the columns\nfunction Monitor({ input, output, hex, allPorts, showMonitor, setShowMonitor }) {\n    const [log, setLog] = useState([]);\n    const [inputPorts, setInputPorts] = useState(allPorts[0]);\n    const [availablePorts, setAvailablePorts] = useState(allPorts[0]);\n    const allMessages = [];\n    const allInputs = allPorts[0];\n    const allOutputs = allPorts[1];\n\n    function logData() {\n        allInputs.forEach((inp, index) => {\n            inp.addListener('midimessage', 'all', e => {\n                const reply = hex([...e.data]);\n                const timestamp = parseInt(e.timestamp);\n                // const name = e.target.name;\n                allMessages.push({ port: e.target.name, time: timestamp, message: reply });\n                // setLog([...allMessages]);\n\n                // console.table(allMessages);\n                setLog([...allMessages]);\n                // console.log(allMessages);\n                // console.log(allMessages);\n                logScroll();\n                // setGroups();\n            });\n        });\n    }\n    // function setGroups() {\n    //     const result = [];\n    //     const grouped = allMessages.reduce((groupedPorts, message) => {\n    //         const name = message.port;\n    //         if (groupedPorts[name] == null) groupedPorts[name] = [];\n    //         groupedPorts[name].push({ time: message.time, message: message.message });\n    //         return groupedPorts;\n    //     }, {});\n    // }\n\n    // Makes the log scroll to the bottom automatically\n    function logScroll() {\n        let logEl = document.querySelectorAll('.monitor-column');\n        logEl.forEach(col => (col.scrollTop = col.scrollHeight));\n    }\n\n    // input.removeListener('midimessage', 'all');\n    useEffect(() => {\n        console.log('render');\n        logData();\n        return () => {\n            input.removeListener('midimessage', 'all');\n            console.log('unmount');\n        };\n    }, [input]);\n\n    function clickHandler(e) {\n        console.log(e.target.id);\n        const target = e.target.id;\n        setInputPorts(prev => prev.filter(port => port.name !== target));\n        console.log(inputPorts);\n    }\n\n    function selectHandler(e) {\n        console.log(e.target.value);\n        console.log(allPorts);\n        const target = e.target.value;\n        setInputPorts(\n            prev => [...prev],\n            allInputs.filter(port => port.name === target)\n        );\n    }\n\n    const classColors = ['cyan', 'violet', 'magenta', 'orange'];\n    // console.log(allPorts);\n    return (\n        <div className='monitor-container'>\n            <button className='button monitor-title' onClick={() => setShowMonitor(!showMonitor)}>\n                MIDI Monitor <span className='orange'> x</span>\n            </button>\n\n            {/* <span className='port-select-container'>\n                Add Port:\n                <select className='port-select' onChange={selectHandler}>\n                    {availablePorts.map(port => (\n                        <option key={port.id}>{port.name}</option>\n                    ))}\n                </select>\n            </span> */}\n            <div className='monitor-content'>\n                {/* \n                The following maps all available midi ports and creates a column \n                of messages if the message's port property matches one of the inputs\n                \n                */}\n                {inputPorts.map((port, index) => (\n                    <div key={port.id} className='columns-container'>\n                        <div id={port.name} className={`column-title ${classColors[index]}`}>\n                            {port.name}\n                        </div>\n                        <div key={port.id} className={`monitor-column`}>\n                            {log.map(msg => {\n                                if (msg.port === port.name) {\n                                    return (\n                                        <div className='midi-message' key={msg.time}>\n                                            {/* <div>{msg.port}</div> */}\n                                            <div id='midi-input-msg'>{msg.message}</div>\n                                            {msg.message.length === 3 ? (\n                                                <div id='midi-input-note'>{`( ${noteTranslator(msg.message[1])} )`}</div>\n                                            ) : (\n                                                <div></div>\n                                            )}\n                                            <div id='midi-input-time'>{msg.time}</div>\n                                        </div>\n                                    );\n                                }\n                                return '';\n                            })}\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n}\n\nexport default Monitor;\n","import React, { useState } from 'react';\nimport MidiPorts from './components/MidiPorts';\nimport ExcelReader from './components/ReadExcel';\nimport ExportExcel from './components/ExportExcel';\nimport HelpButton from './components/HelpButton';\nimport Window from './components/Window';\nimport CopyButton from './components/CopyButton';\nimport SendButton from './components/SendButton';\nimport Monitor from './components/Monitor';\nimport './Header.css';\nimport './App.css';\nimport './Monitor.css';\n\n//TODO: move button styling to own file, change import order to remove !important flags\n//TODO: error handling for if no sysex, or remove sysex button if no data\n//TODO: clear response and reset sent state\n//TODO: make midi monitor button in the monitor also close it\n//TODO: change button state when new sheet is imported\n//TODO: change color of copy button\n\nfunction App() {\n    const [items, setItems] = useState([]);\n    const [input, setInput] = useState();\n    const [output, setOutput] = useState();\n    const [allPorts, setAllPorts] = useState([]);\n    const [viewHelp, setViewHelp] = useState(true);\n    const [showMonitor, setShowMonitor] = useState(true);\n\n    function clickHandler(e) {\n        console.log('test', e);\n        const target = parseInt(e.target.id);\n\n        // e.target.innerText = 'sent';\n        // e.target.classList.add('sent');\n        // e.target.classList.add('sent');\n\n        // console.log('click target', target);\n\n        // Finds cell sysex message based on the target ID, which matches the index\n        let msg = items[target].sysex;\n        let byteArray = msg.split(' ');\n\n        // Converts proper hex format, then to decimal so that message can be read by the computer\n        const message = byteArray.map(el => {\n            el = '0x' + el;\n            return parseInt(Number(el, 10));\n        });\n\n        // Get the status byte and remove it from the message while storing it in this variable\n        const statusByte = message.splice(0, 1);\n        const fullMsg = `${statusByte},${message}`;\n\n        // Do not send if output does not include the terminator byte\n        // if (!message.includes(247)) {\n        // return alert('Not a valid SysEx message');\n        // }\n        // Send to output if one is available\n\n        if (output) {\n            output.send(statusByte, message);\n            receiveSysex(target); // Full message is sent for easy logging\n            console.group('LOG');\n            console.log(`SENT ${fullMsg} (${fullMsg.length} bytes) to ${output.name} port`);\n        } else {\n            alert('No MIDI output port selected');\n        }\n    }\n\n    function receiveSysex(target) {\n        clean();\n        input.addListener('sysex', 'all', e => {\n            console.log('TARGET', target);\n            const reply = [...e.data];\n\n            // Log I/O\n            if (!reply) alert('No SysEx received. Check MIDI Port');\n            // console.group('Success');\n            console.log(`RECEIVED ${reply} (${reply.length} bytes) at ${input.name} port`);\n            console.groupEnd('LOG');\n\n            if (reply) {\n                updateData(target, decimalToHex(reply));\n            }\n            return;\n        });\n    }\n\n    function clean() {\n        console.groupEnd('LOG');\n        input.removeListener('sysex', 'all'); // Remove the event listener so that they aren't created every button press\n    }\n    function decimalToHex(reply) {\n        const converter = reply.map(el => {\n            el = el.toString(16) + ' ';\n            if (el.length === 2) el = '0' + el;\n            return el.toUpperCase();\n        });\n        return converter;\n    }\n\n    function byteComparison(message) {\n        return message.length;\n    }\n\n    function updateData(target, response) {\n        setItems(prev => {\n            const newitems = prev.map(entry => {\n                if (entry.index === target) {\n                    entry.response = response;\n                    entry.expectedLength = entry.expected.split(' ').length;\n                    entry.responseLength = byteComparison(response);\n                }\n                if (entry.responseLength === entry.expectedLength) {\n                    entry.passFail = 'pass';\n                }\n                if (entry.responseLength !== entry.expectedLength) {\n                    entry.passFail = 'fail';\n                }\n                return entry;\n            });\n            target = null;\n            return newitems;\n        });\n    }\n\n    return (\n        <div className='container'>\n            <p className='title'>Sysex Tester v0.3.1</p>\n            <div className='utilities'>\n                <ExcelReader setItems={setItems} setHelp={setViewHelp} help={viewHelp} />\n                <ExportExcel data={items} />\n                <MidiPorts setInput={setInput} setOutput={setOutput} input={input} output={output} setAll={setAllPorts} />\n                <button className='button' onClick={() => setShowMonitor(!showMonitor)}>\n                    MIDI Monitor\n                </button>\n                <HelpButton help={viewHelp} setHelp={setViewHelp} />\n            </div>\n            {viewHelp ? <Window /> : ''}\n            <div className='main-container'>\n                <table className='table-container'>\n                    <thead>\n                        <tr className={items.length > 2 ? 'table-header' : 'invisible'}>\n                            <th className='header__item'>Message Type</th>\n                            <th>Port</th>\n                            <th>Test</th>\n                            <th>Expected Behavior</th>\n                            <th>SysEx to Send</th>\n                            <th>Expected Response</th>\n                            <th>Response</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {items.map((data, index) => (\n                            <tr key={index} className={data.port === undefined ? 'table_section' : 'table_row'}>\n                                <td className='msg_name'>{data.name}</td>\n                                <td className='port'>{data.port}</td>\n                                {/* Sysex Column */}\n                                <td className='description'>{data.test}</td>\n                                <td className='behavior'>{data.behavior}</td>\n                                <td className='sysex-container'>\n                                    <div className={data.sysex ? 'sysex-cell' : 'invisible'}>\n                                        {data.sysex}\n                                        <SendButton id={index} onClick={clickHandler} />\n                                        {/* <button className={data.sysex ? 'send-button button' : 'invisible'} id={index} onClick={clickHandler}>\n                                            send{' '}\n                                        </button> */}\n                                    </div>\n                                </td>\n\n                                <td className='long expected'>\n                                    <div className='overflow'>\n                                        {data.expected}\n                                        <div className={data.passFail === 'pass' ? 'pass' : 'fail'}>\n                                            {data.expectedLength ? `Expected: ${data.expectedLength} bytes` : ''}\n                                        </div>\n                                    </div>\n                                </td>\n                                <td className='long response'>\n                                    <div className='overflow'>\n                                        {data.response}\n                                        <div className={data.passFail === 'pass' ? 'pass' : 'fail'}>\n                                            {data.responseLength ? `Response: ${data.responseLength} bytes` : ''}\n                                        </div>\n                                    </div>\n                                    {data.responseLength > 1 ? <CopyButton data={data.response} dataLength={data.responseLength} /> : undefined}\n                                </td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n                {input && showMonitor ? (\n                    <Monitor\n                        input={input}\n                        output={output}\n                        hex={decimalToHex}\n                        allPorts={allPorts}\n                        showMonitor={showMonitor}\n                        setShowMonitor={setShowMonitor}\n                    />\n                ) : (\n                    ''\n                )}\n            </div>\n\n            {/* <footer>Â© Copyright 2021 John DeTora. All rights reserved.</footer> */}\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}